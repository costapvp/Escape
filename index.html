<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ø´Ø±Ø·ÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            direction: rtl;
            position: fixed;
            width: 100%;
            height: 100%;
            touch-action: none;
        }

        #gameContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
        }

        #gameCanvas {
            display: block;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            touch-action: none;
        }

        #gameUI {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 100;
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 10px;
        }

        #levelUp {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 215, 0, 0.9);
            color: #000;
            font-size: 24px;
            font-weight: bold;
            padding: 20px;
            border-radius: 15px;
            display: none;
            z-index: 150;
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translate(-50%, -50%) translateY(0); }
            40% { transform: translate(-50%, -50%) translateY(-10px); }
            80% { transform: translate(-50%, -50%) translateY(-5px); }
        }

        #startScreen, #gameOverScreen, #clothesScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 200;
            overflow-y: auto;
            padding: 20px;
        }

        #gameOverScreen, #clothesScreen {
            display: none;
        }

        button {
            padding: 12px 25px;
            font-size: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s;
            min-height: 44px;
            min-width: 100px;
        }

        button:hover, button:active {
            background: #45a049;
            transform: scale(0.95);
        }

        .character-btn {
            background: #2196F3;
            margin: 5px;
            padding: 12px 20px;
            font-size: 14px;
        }

        .character-btn:hover, .character-btn:active {
            background: #1976D2;
        }

        .character-btn.selected {
            background: #FF9800;
        }

        .clothes-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 20px 0;
            max-width: 400px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            background: rgba(0,0,0,0.2);
        }

        .clothes-btn {
            background: #9C27B0;
            font-size: 18px;
            padding: 10px;
            border-radius: 8px;
            min-height: 50px;
            min-width: 50px;
            position: relative;
            transition: all 0.3s ease;
        }

        .clothes-btn:hover, .clothes-btn:active {
            background: #7B1FA2;
            transform: scale(1.05);
        }

        .clothes-btn.selected {
            background: #FF5722;
            box-shadow: 0 0 15px rgba(255, 87, 34, 0.5);
            transform: scale(1.1);
        }

        .clothes-btn.locked {
            background: #424242;
            opacity: 0.5;
            cursor: not-allowed;
        }

        .clothes-btn.locked:hover {
            background: #424242;
            transform: none;
        }

        .level-indicator {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #FF9800;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        #instructions {
            text-align: center;
            margin: 15px;
            font-size: 14px;
            line-height: 1.4;
        }

        .mobile-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 100;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            color: white;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }

        .control-btn:active {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0.9);
        }

        .character-animation {
            animation: characterMove 0.5s ease-in-out;
        }

        @keyframes characterMove {
            0% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(-5deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
            75% { transform: translateY(-5px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }

        .special-effect {
            animation: sparkle 1s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @media (max-width: 480px) {
            #gameUI {
                font-size: 14px;
                top: 5px;
                right: 5px;
                padding: 8px;
            }
            
            button {
                font-size: 14px;
                padding: 10px 20px;
            }
            
            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <div id="gameUI">
            <div>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
            <div>Ø§Ù„Ø£Ù…ÙˆØ§Ù„: <span id="coins">0</span></div>
            <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></div>
        </div>

        <div id="levelUp">
            ğŸ‰ Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯! ğŸ‰
            <div style="font-size: 18px; margin-top: 10px;">ØªÙ… ÙØªØ­ Ù…Ù„Ø§Ø¨Ø³ Ø¬Ø¯ÙŠØ¯Ø©!</div>
        </div>

        <div class="mobile-controls">
            <div class="control-btn" id="leftBtn">â†</div>
            <div class="control-btn" id="jumpBtn">â†‘</div>
            <div class="control-btn" id="rightBtn">â†’</div>
        </div>

        <div id="startScreen">
            <h1 style="font-size: 36px; margin-bottom: 20px; color: #FFD700;">ğŸƒâ€â™‚ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ø´Ø±Ø·ÙŠ</h1>
            
            <div id="instructions">
                <p>ğŸ® Ù„Ø¹Ø¨Ø© Ø³Ù‡Ù„Ø© ÙˆÙ…ØªØ¯Ø±Ø¬Ø© Ø§Ù„ØµØ¹ÙˆØ¨Ø©!</p>
                <p>â¬†ï¸ Ø§Ù‚ÙØ² ÙÙˆÙ‚ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙˆØ§Ù„Ù‚Ø·Ø§Ø±Ø§Øª</p>
                <p>â¬…ï¸â¡ï¸ ØªØ­Ø±Ùƒ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø«Ù„Ø§Ø«Ø©</p>
                <p>ğŸ’° Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„ÙƒØ«ÙŠØ±Ø©!</p>
                <p>ğŸ‘®â€â™‚ï¸ Ø§Ù‡Ø±Ø¨ Ù…Ù† Ø§Ù„Ø´Ø±Ø·ÙŠ!</p>
                <p>ğŸ“ˆ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 1-3: Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹ (Ø³ÙŠØ§Ø±Ø§Øª ØµØºÙŠØ±Ø©)</p>
                <p>ğŸ“ˆ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 4-6: Ø³Ù‡Ù„ (Ø³ÙŠØ§Ø±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©)</p>
                <p>ğŸ“ˆ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª 7+: ØªØ­Ø¯ÙŠ ØªØ¯Ø±ÙŠØ¬ÙŠ!</p>
                <p>ğŸ‘• 120 Ø²ÙŠ Ù…Ø®ØªÙ„Ù ÙÙŠ 20 Ù…Ø³ØªÙˆÙ‰!</p>
            </div>

            <div style="margin: 15px;">
                <h3>Ø§Ø®ØªØ± Ø´Ø®ØµÙŠØªÙƒ:</h3>
                <div style="display: flex; flex-wrap: wrap; justify-content: center;">
                    <button class="character-btn selected" data-character="boy">ğŸ§‘â€ğŸ¦± Ø§Ù„ÙˆÙ„Ø¯</button>
                    <button class="character-btn" data-character="girl">ğŸ‘©â€ğŸ¦° Ø§Ù„Ø£Ø®Øª</button>
                    <button class="character-btn" data-character="father">ğŸ‘¨â€ğŸ¦² Ø§Ù„Ø£Ø¨</button>
                    <button class="character-btn" data-character="mother">ğŸ‘©â€ğŸ¦³ Ø§Ù„Ø£Ù…</button>
                </div>
            </div>

            <button onclick="showClothesScreen()">ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ ğŸ‘•</button>
            <button onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
        </div>

        <div id="clothesScreen">
            <h2 style="font-size: 28px; margin-bottom: 20px;">ğŸ‘• Ø§Ø®ØªØ± Ù…Ù„Ø§Ø¨Ø³Ùƒ</h2>
            <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="clothesLevel">1</span></div>
            <div style="margin-bottom: 20px;">Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ù…ØªØ§Ø­Ø© Ø­Ø³Ø¨ Ù…Ø³ØªÙˆØ§Ùƒ</div>
            
            <div class="clothes-grid" id="clothesGrid">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ù€ JavaScript -->
            </div>
            
            <div style="margin: 15px; font-size: 14px; text-align: center;">
                <p>ğŸ¯ ÙƒÙ„ 100 Ù†Ù‚Ø·Ø© = Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯</p>
                <p>ğŸ“ˆ 20 Ù…Ø³ØªÙˆÙ‰ Ù…Ø¹ 120 Ø²ÙŠ Ù…Ø®ØªÙ„Ù!</p>
                <p>ğŸ”“ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1-5: Ù…Ù„Ø§Ø¨Ø³ Ø¹Ø§Ø¯ÙŠØ©</p>
                <p>âš¡ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 6-10: Ø´Ø®ØµÙŠØ§Øª Ø®Ø§Ø±Ù‚Ø©</p>
                <p>ğŸŒŸ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 11-15: Ø£Ø²ÙŠØ§Ø¡ Ù…Ù…ÙŠØ²Ø©</p>
                <p>ğŸ† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 16-20: Ø£Ø²ÙŠØ§Ø¡ Ø£Ø³Ø·ÙˆØ±ÙŠØ©</p>
            </div>
            
            <button onclick="backToStart()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>

        <div id="gameOverScreen">
            <h2 style="font-size: 28px; margin-bottom: 15px;">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ˜µ</h2>
            <div style="font-size: 20px; margin-bottom: 15px;">
                <div>Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: <span id="finalScore">0</span></div>
                <div>Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©: <span id="finalCoins">0</span></div>
                <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø­Ù‚Ù‚: <span id="finalLevel">1</span></div>
            </div>
            <button onclick="restartGame()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
            <button onclick="showStartScreen()">Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ù„Ù„Ù‡Ø§ØªÙ
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        let gameRunning = false;
        let score = 0;
        let coins = 0;
        let level = 1;
        let gameSpeed = 3;
        let selectedCharacter = 'boy';
        let selectedClothes = 'ğŸ‘•';
        let animationFrame = 0;
        let isMoving = false;
        let specialEffect = false;

        // Ø´Ø®ØµÙŠØ§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© - Ø§Ù„Ø¬Ø³Ø¯ ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙŠØ¯ÙŠÙ† ÙˆØ§Ù„Ù‚Ø¯Ù…ÙŠÙ†
        const characters = {
            boy: {
                body: 'ğŸ‘¤',
                running: ['ğŸƒâ€â™‚ï¸', 'ğŸƒâ€â™‚ï¸'],
                jumping: 'ğŸ¤¸â€â™‚ï¸',
                landing: 'ğŸ¤¾â€â™‚ï¸'
            },
            girl: {
                body: 'ğŸ‘¤',
                running: ['ğŸƒâ€â™€ï¸', 'ğŸƒâ€â™€ï¸'],
                jumping: 'ğŸ¤¸â€â™€ï¸',
                landing: 'ğŸ¤¾â€â™€ï¸'
            },
            father: {
                body: 'ğŸ‘¤',
                running: ['ğŸƒâ€â™‚ï¸', 'ğŸƒâ€â™‚ï¸'],
                jumping: 'ğŸ¤¸â€â™‚ï¸',
                landing: 'ğŸ¤¾â€â™‚ï¸'
            },
            mother: {
                body: 'ğŸ‘¤',
                running: ['ğŸƒâ€â™€ï¸', 'ğŸƒâ€â™€ï¸'],
                jumping: 'ğŸ¤¸â€â™€ï¸',
                landing: 'ğŸ¤¾â€â™€ï¸'
            }
        };

        // Ù…Ù„Ø§Ø¨Ø³ Ù…ØªØ§Ø­Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ - Ù…Ù„Ø§Ø¨Ø³ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„Ø¬Ø³Ù…
        const clothesByLevel = {
            1: ['ğŸ‘•', 'ğŸ‘”', 'ğŸ¦º', 'ğŸ‘¶', 'ğŸ§’'],
            2: ['ğŸ‘—', 'ğŸ‘˜', 'ğŸ¥¼', 'ğŸ‘¯â€â™€ï¸', 'ğŸ’ƒ', 'ğŸ•º'],
            3: ['ğŸ§¥', 'ğŸ‘š', 'ğŸ¥»', 'ğŸ§¦', 'ğŸ‘¢', 'ğŸ‘ '],
            4: ['ğŸ¦¸â€â™‚ï¸', 'ğŸ¦¸â€â™€ï¸', 'ğŸ§™â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ¦¹â€â™‚ï¸', 'ğŸ¦¹â€â™€ï¸'],
            5: ['ğŸ‘®â€â™‚ï¸', 'ğŸ‘®â€â™€ï¸', 'ğŸ‘¨â€âš•ï¸', 'ğŸ‘©â€âš•ï¸', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ³'],
            6: ['ğŸ‘¨â€ğŸ’¼', 'ğŸ‘©â€ğŸ’¼', 'ğŸ‘¨â€ğŸ”§', 'ğŸ‘©â€ğŸ”§', 'ğŸ‘¨â€ğŸš€', 'ğŸ‘©â€ğŸš€'],
            7: ['ğŸ§›â€â™‚ï¸', 'ğŸ§›â€â™€ï¸', 'ğŸ§Ÿâ€â™‚ï¸', 'ğŸ§Ÿâ€â™€ï¸', 'ğŸ‘º', 'ğŸ‘¹'],
            8: ['ğŸ§šâ€â™‚ï¸', 'ğŸ§šâ€â™€ï¸', 'ğŸ§œâ€â™‚ï¸', 'ğŸ§œâ€â™€ï¸', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸'],
            9: ['ğŸ‘¸', 'ğŸ¤´', 'ğŸ‘°â€â™€ï¸', 'ğŸ‘°â€â™‚ï¸', 'ğŸ¤µâ€â™‚ï¸', 'ğŸ¤µâ€â™€ï¸'],
            10: ['ğŸ…', 'ğŸ¤¶', 'ğŸ§‘â€ğŸ„', 'ğŸª', 'ğŸ¤¹â€â™‚ï¸', 'ğŸ¤¹â€â™€ï¸'],
            11: ['ğŸ‘¨â€ğŸ¨', 'ğŸ‘©â€ğŸ¨', 'ğŸ‘¨â€ğŸ¤', 'ğŸ‘©â€ğŸ¤', 'ğŸ‘¨â€ğŸ“', 'ğŸ‘©â€ğŸ“'],
            12: ['ğŸ‘¨â€ğŸ’»', 'ğŸ‘©â€ğŸ’»', 'ğŸ‘¨â€ğŸ”¬', 'ğŸ‘©â€ğŸ”¬', 'ğŸ‘¨â€ğŸ«', 'ğŸ‘©â€ğŸ«'],
            13: ['ğŸ‘¨â€ğŸŒ¾', 'ğŸ‘©â€ğŸŒ¾', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ³', 'ğŸ‘¨â€âš–ï¸', 'ğŸ‘©â€âš–ï¸'],
            14: ['ğŸ‘¨â€âœˆï¸', 'ğŸ‘©â€âœˆï¸', 'ğŸ‘¨â€ğŸš’', 'ğŸ‘©â€ğŸš’', 'ğŸ‘¨â€âš•ï¸', 'ğŸ‘©â€âš•ï¸'],
            15: ['ğŸ‘¨â€ğŸ­', 'ğŸ‘©â€ğŸ­', 'ğŸ¤–', 'ğŸ‘½', 'ğŸ‘»', 'ğŸ’€'],
            16: ['ğŸ¦„', 'ğŸ‰', 'ğŸ¦‹', 'ğŸŒŸ', 'â­', 'âœ¨'],
            17: ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¹', 'ğŸŒ·', 'ğŸŒ¼'],
            18: ['ğŸ¦', 'ğŸ¯', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸµ'],
            19: ['âš½', 'ğŸ€', 'ğŸˆ', 'âš¾', 'ğŸ¾', 'ğŸ'],
            20: ['ğŸŠ', 'ğŸ‰', 'ğŸˆ', 'ğŸ€', 'ğŸ', 'ğŸ’']
        };

        // Ø§Ù„Ù„Ø§Ø¹Ø¨
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 150,
            width: 60,
            height: 80,
            velocityY: 0,
            jumping: false,
            landing: false,
            lane: 1,
            character: characters.boy,
            currentClothes: 'ğŸ‘•',
            animating: false,
            jumpHeight: 0,
            runningFrame: 0,
            landingTimer: 0
        };

        // Ø§Ù„Ø´Ø±Ø·ÙŠ
        const police = {
            x: canvas.width / 2,
            y: canvas.height - 200,
            width: 60,
            height: 80,
            character: 'ğŸ‘®â€â™‚ï¸',
            runningFrame: 0
        };

        // Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª ÙˆØ§Ù„Ø£Ù…ÙˆØ§Ù„
        let obstacles = [];
        let moneyCoins = [];
        let particles = [];

        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø­Ø³Ù† Ù„Ù„Ù‡Ø§ØªÙ
        let touchStartX = 0;
        let touchStartY = 0;
        let isSwipeGesture = false;
        const swipeThreshold = 30;
        const tapTimeout = 200;

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù‡Ø§ØªÙ
        document.getElementById('leftBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            moveLeft();
        });

        document.getElementById('rightBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            moveRight();
        });

        document.getElementById('jumpBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });

        // Ù…Ù†Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø³
        document.addEventListener('touchmove', (e) => {
            e.preventDefault();
        }, { passive: false });

        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
        function moveLeft() {
            if (player.lane > 0) {
                player.lane--;
                updatePlayerPosition();
                player.animating = true;
                setTimeout(() => { player.animating = false; }, 300);
            }
        }

        function moveRight() {
            if (player.lane < 2) {
                player.lane++;
                updatePlayerPosition();
                player.animating = true;
                setTimeout(() => { player.animating = false; }, 300);
            }
        }

        function jump() {
            if (!player.jumping && !player.landing) {
                player.velocityY = -16; // Ù‚ÙØ²Ø© Ø£Ù‚Ù„ Ø§Ø±ØªÙØ§Ø¹Ø§Ù‹ Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
                player.jumping = true;
                player.landing = false;
                player.animating = true;
                player.jumpHeight = 0;
                setTimeout(() => { player.animating = false; }, 600);
            }
        }

        function updatePlayerPosition() {
            const laneWidth = canvas.width / 3;
            player.x = laneWidth * player.lane + (laneWidth / 2) - (player.width / 2);
        }

        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            isSwipeGesture = false;
        }, { passive: false });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!gameRunning) return;
            
            const touchX = e.touches[0].clientX;
            const touchY = e.touches[0].clientY;
            const deltaX = touchX - touchStartX;
            const deltaY = touchY - touchStartY;

            if (Math.abs(deltaX) > swipeThreshold || Math.abs(deltaY) > swipeThreshold) {
                isSwipeGesture = true;
                
                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    // Ø­Ø±ÙƒØ© Ø£ÙÙ‚ÙŠØ© Ø³Ø±ÙŠØ¹Ø©
                    if (deltaX > swipeThreshold) {
                        moveRight();
                        touchStartX = touchX; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù„Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©
                    } else if (deltaX < -swipeThreshold) {
                        moveLeft();
                        touchStartX = touchX;
                    }
                } else if (deltaY < -swipeThreshold) {
                    // Ø­Ø±ÙƒØ© Ø¹Ù…ÙˆØ¯ÙŠØ© Ù„Ù„Ù‚ÙØ²
                    jump();
                    touchStartY = touchY;
                }
            }
        }, { passive: false });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            if (!isSwipeGesture && gameRunning) {
                // Ù†Ù‚Ø±Ø© Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ù‚ÙØ²
                jump();
            }
        }, { passive: false });

        // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ©
        document.querySelectorAll('.character-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.character-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                selectedCharacter = btn.dataset.character;
                updateClothesLevel();
            });
        });

        function showClothesScreen() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('clothesScreen').style.display = 'flex';
            updateClothesGrid();
        }

        function backToStart() {
            document.getElementById('clothesScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';
        }

        function updateClothesLevel() {
            document.getElementById('clothesLevel').textContent = level;
        }

        function updateClothesGrid() {
            const grid = document.getElementById('clothesGrid');
            grid.innerHTML = '';
            
            // Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø§Ø¯ Ù„Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ù…ØªØ§Ø­Ø©
            let availableCount = 0;
            let totalCount = 0;
            
            for (let lvl = 1; lvl <= 20; lvl++) {
                if (clothesByLevel[lvl]) {
                    clothesByLevel[lvl].forEach(clothes => {
                        totalCount++;
                        const btn = document.createElement('button');
                        btn.className = 'clothes-btn';
                        btn.innerHTML = clothes;
                        
                        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                        const levelIndicator = document.createElement('div');
                        levelIndicator.className = 'level-indicator';
                        levelIndicator.textContent = lvl;
                        btn.appendChild(levelIndicator);
                        
                        if (lvl <= level) {
                            // Ù…ØªØ§Ø­
                            availableCount++;
                            if (clothes === selectedClothes) {
                                btn.classList.add('selected');
                            }
                            btn.addEventListener('click', () => {
                                document.querySelectorAll('.clothes-btn').forEach(b => b.classList.remove('selected'));
                                btn.classList.add('selected');
                                selectedClothes = clothes;
                            });
                        } else {
                            // Ù…Ù‚ÙÙ„
                            btn.classList.add('locked');
                            btn.title = `ÙŠÙØªØ­ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${lvl}`;
                        }
                        
                        grid.appendChild(btn);
                    });
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù„Ø§Ø¨Ø³
            const counterDiv = document.createElement('div');
            counterDiv.style.cssText = 'grid-column: 1/-1; text-align: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 5px; margin-top: 10px;';
            counterDiv.innerHTML = `
                <div style="font-size: 16px; font-weight: bold;">ğŸ“Š Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
                <div style="font-size: 14px; margin-top: 5px;">${availableCount} Ù…Ù† ${totalCount} Ø²ÙŠ Ù…ØªØ§Ø­</div>
                <div style="font-size: 12px; color: #FFD700; margin-top: 3px;">ğŸ”“ ${Math.max(0, (level * 6) - availableCount)} Ø²ÙŠ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‚Ø§Ø¯Ù…</div>
            `;
            grid.appendChild(counterDiv);
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('clothesScreen').style.display = 'none';
            gameRunning = true;
            score = 0;
            coins = 0;
            gameSpeed = 3;
            animationFrame = 0;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨
            player.character = characters[selectedCharacter];
            player.currentClothes = selectedClothes;
            updatePlayerPosition();
            player.y = canvas.height - 150;
            player.velocityY = 0;
            player.jumping = false;
            player.landing = false;
            player.lane = 1;
            player.runningFrame = 0;
            player.landingTimer = 0;

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØµÙÙˆÙØ§Øª
            obstacles = [];
            moneyCoins = [];
            particles = [];

            gameLoop();
        }

        function restartGame() {
            document.getElementById('gameOverScreen').style.display = 'none';
            startGame();
        }

        function showStartScreen() {
            document.getElementById('gameOverScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';
            gameRunning = false;
        }

        function gameOver() {
            gameRunning = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalCoins').textContent = coins;
            document.getElementById('finalLevel').textContent = level;
            document.getElementById('gameOverScreen').style.display = 'flex';
        }

        function checkLevelUp() {
            const newLevel = Math.floor(score / 100) + 1;
            if (newLevel > level) {
                level = newLevel;
                showLevelUp();
                specialEffect = true;
                setTimeout(() => { specialEffect = false; }, 3000);
            }
        }

        function showLevelUp() {
            const levelUpDiv = document.getElementById('levelUp');
            levelUpDiv.style.display = 'block';
            setTimeout(() => {
                levelUpDiv.style.display = 'none';
            }, 2000);
        }

        function updatePlayer() {
            // ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ù‚ÙØ² Ø§Ù„Ù…Ø­Ø³Ù†Ø© ÙˆØ§Ù„Ø³Ù‡Ù„Ø©
            if (player.jumping) {
                player.y += player.velocityY;
                player.velocityY += 0.8; // Ø¬Ø§Ø°Ø¨ÙŠØ© Ø£Ù‚Ù„ Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
                player.jumpHeight = Math.abs(player.velocityY);

                if (player.y >= canvas.height - 150) {
                    player.y = canvas.height - 150;
                    player.jumping = false;
                    player.landing = true;
                    player.landingTimer = 20; // Ù…Ø¯Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ù‡Ø¨ÙˆØ·
                    player.velocityY = 0;
                    player.jumpHeight = 0;
                }
            }

            // Ø­Ø±ÙƒØ© Ø§Ù„Ù‡Ø¨ÙˆØ·
            if (player.landing) {
                player.landingTimer--;
                if (player.landingTimer <= 0) {
                    player.landing = false;
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø¥Ø·Ø§Ø± Ø§Ù„Ø­Ø±ÙƒØ© Ù„Ù„Ø¬Ø±ÙŠ
            if (!player.jumping && !player.landing) {
                player.runningFrame = (player.runningFrame + 0.2) % 2;
            }
        }

        function createObstacle() {
            // ØªØ¯Ø±Ø¬ Ø§Ù„ØµØ¹ÙˆØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            let spawnRate = 0.015; // Ù…Ø¹Ø¯Ù„ Ø£Ø³Ø§Ø³ÙŠ Ù…Ù†Ø®ÙØ¶
            
            if (level <= 3) {
                spawnRate = 0.012; // Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹
            } else if (level <= 6) {
                spawnRate = 0.018; // Ø³Ù‡Ù„
            } else if (level <= 10) {
                spawnRate = 0.025; // Ù…ØªÙˆØ³Ø·
            } else if (level <= 15) {
                spawnRate = 0.032; // ØµØ¹Ø¨
            } else {
                spawnRate = 0.040; // ØµØ¹Ø¨ Ø¬Ø¯Ø§Ù‹
            }
            
            if (Math.random() < spawnRate) {
                const lane = Math.floor(Math.random() * 3);
                const laneWidth = canvas.width / 3;
                
                // Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                let obstacle;
                
                if (level <= 3) {
                    // Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø³ÙŠØ§Ø±Ø§Øª ØµØºÙŠØ±Ø© ÙÙ‚Ø·
                    const easyCars = ['ğŸš—', 'ğŸš•', 'ğŸš™'];
                    obstacle = {
                        x: laneWidth * lane + (laneWidth / 2) - 25,
                        y: -60,
                        width: 50,
                        height: 50,
                        type: easyCars[Math.floor(Math.random() * easyCars.length)],
                        category: 'vehicle',
                        canJumpOver: true
                    };
                } else if (level <= 6) {
                    // Ù…Ø³ØªÙˆÙŠØ§Øª Ù…ØªÙˆØ³Ø·Ø©: Ø³ÙŠØ§Ø±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©
                    const mediumCars = ['ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸'];
                    obstacle = {
                        x: laneWidth * lane + (laneWidth / 2) - 30,
                        y: -65,
                        width: 60,
                        height: 55,
                        type: mediumCars[Math.floor(Math.random() * mediumCars.length)],
                        category: 'vehicle',
                        canJumpOver: true
                    };
                } else if (level <= 10) {
                    // Ù…Ø³ØªÙˆÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©: Ù‚Ø·Ø§Ø±Ø§Øª ÙˆØ³ÙŠØ§Ø±Ø§Øª
                    const obstacleType = Math.random();
                    if (obstacleType < 0.6) {
                        const allCars = ['ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸', 'ğŸš“', 'ğŸš‘', 'ğŸš’'];
                        obstacle = {
                            x: laneWidth * lane + (laneWidth / 2) - 30,
                            y: -70,
                            width: 60,
                            height: 60,
                            type: allCars[Math.floor(Math.random() * allCars.length)],
                            category: 'vehicle',
                            canJumpOver: true
                        };
                    } else {
                        const smallTrains = ['ğŸšŠ', 'ğŸš‹', 'ğŸš‡'];
                        obstacle = {
                            x: laneWidth * lane + (laneWidth / 2) - 35,
                            y: -75,
                            width: 70,
                            height: 65,
                            type: smallTrains[Math.floor(Math.random() * smallTrains.length)],
                            category: 'train',
                            canJumpOver: true
                        };
                    }
                } else {
                    // Ù…Ø³ØªÙˆÙŠØ§Øª ØµØ¹Ø¨Ø©: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ + Ø­ÙØ±
                    const obstacleType = Math.random();
                    if (obstacleType < 0.4) {
                        const allCars = ['ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸', 'ğŸš“', 'ğŸš‘', 'ğŸš’', 'ğŸš', 'ğŸ›»'];
                        obstacle = {
                            x: laneWidth * lane + (laneWidth / 2) - 30,
                            y: -70,
                            width: 60,
                            height: 60,
                            type: allCars[Math.floor(Math.random() * allCars.length)],
                            category: 'vehicle',
                            canJumpOver: true
                        };
                    } else if (obstacleType < 0.8) {
                        const allTrains = ['ğŸš‚', 'ğŸš†', 'ğŸšŠ', 'ğŸš‹', 'ğŸš„', 'ğŸš…', 'ğŸš‡', 'ğŸšˆ'];
                        obstacle = {
                            x: laneWidth * lane + (laneWidth / 2) - 35,
                            y: -80,
                            width: 70,
                            height: 70,
                            type: allTrains[Math.floor(Math.random() * allTrains.length)],
                            category: 'train',
                            canJumpOver: true
                        };
                    } else {
                        const roadHazards = ['ğŸ•³ï¸', 'âš¡', 'ğŸ’¥'];
                        obstacle = {
                            x: laneWidth * lane + (laneWidth / 2) - 25,
                            y: -50,
                            width: 50,
                            height: 30,
                            type: roadHazards[Math.floor(Math.random() * roadHazards.length)],
                            category: 'road',
                            canJumpOver: true,
                            onGround: true
                        };
                    }
                }
                
                obstacles.push(obstacle);
            }
        }', 'ğŸšœ'];
                const selectedType = obstacleTypes[Math.floor(Math.random() * obstacleTypes.length)];
                
                obstacles.push({
                    x: laneWidth * lane + (laneWidth / 2) - 30,
                    y: -70,
                    width: 60,
                    height: 60,
                    type: selectedType,
                    canJumpOver: true
                });
            }
        }

        function createMoney() {
            // Ø²ÙŠØ§Ø¯Ø© Ù…Ø¹Ø¯Ù„ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
            let coinRate = 0.025; // Ù…Ø¹Ø¯Ù„ Ø£Ø³Ø§Ø³ÙŠ Ø¹Ø§Ù„ÙŠ
            
            if (level <= 3) {
                coinRate = 0.035; // ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            } else if (level <= 6) {
                coinRate = 0.030;
            } else if (level <= 10) {
                coinRate = 0.025;
            } else {
                coinRate = 0.020;
            }
            
            if (Math.random() < coinRate) {
                const lane = Math.floor(Math.random() * 3);
                const laneWidth = canvas.width / 3;
                moneyCoins.push({
                    x: laneWidth * lane + (laneWidth / 2) - 20,
                    y: -40,
                    width: 40,
                    height: 40
                });
            }
        }

        function createParticle(x, y) {
            for (let i = 0; i < 5; i++) {
                particles.push({
                    x: x,
                    y: y,
                    velocityX: (Math.random() - 0.5) * 4,
                    velocityY: -Math.random() * 3,
                    life: 30,
                    maxLife: 30
                });
            }
        }

        function updateObstacles() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].y += gameSpeed;
                
                if (obstacles[i].y > canvas.height) {
                    obstacles.splice(i, 1);
                    score += 15;
                    checkLevelUp();
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù…ÙˆØ§Ù„
            for (let i = moneyCoins.length - 1; i >= 0; i--) {
                moneyCoins[i].y += gameSpeed;
                
                if (moneyCoins[i].y > canvas.height) {
                    moneyCoins.splice(i, 1);
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
            for (let i = particles.length - 1; i >= 0; i--) {
                const particle = particles[i];
                particle.x += particle.velocityX;
                particle.y += particle.velocityY;
                particle.velocityY += 0.1;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function checkCollisions() {
            // Ø§Ù„ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª - Ù†Ø¸Ø§Ù… Ø£ÙƒØ«Ø± ØªØ³Ø§Ù…Ø­Ø§Ù‹
            obstacles.forEach((obstacle, index) => {
                // ØªÙ‚Ù„ÙŠÙ„ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØµØ§Ø¯Ù… Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
                const playerHitBox = {
                    x: player.x + 10,
                    y: player.y + 10,
                    width: player.width - 20,
                    height: player.height - 20
                };
                
                const obstacleHitBox = {
                    x: obstacle.x + 5,
                    y: obstacle.y + 5,
                    width: obstacle.width - 10,
                    height: obstacle.height - 10
                };
                
                if (playerHitBox.x < obstacleHitBox.x + obstacleHitBox.width &&
                    playerHitBox.x + playerHitBox.width > obstacleHitBox.x &&
                    playerHitBox.y < obstacleHitBox.y + obstacleHitBox.height &&
                    playerHitBox.y + playerHitBox.height > obstacleHitBox.y) {
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙŠÙ‚ÙØ²ØŒ ÙŠÙ…ÙƒÙ†Ù‡ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø© Ø£ÙƒØ¨Ø±
                    if (player.jumping && playerHitBox.y + playerHitBox.height < obstacleHitBox.y + 30) {
                        // Ù†Ø¬Ø­ ÙÙŠ Ø§Ù„Ù‚ÙØ² ÙÙˆÙ‚ Ø§Ù„Ø¹Ù‚Ø¨Ø©
                        score += 20; // Ù†Ù‚Ø§Ø· Ø¥Ø¶Ø§ÙÙŠØ©
                        obstacles.splice(index, 1); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø©
                        createParticle(obstacle.x, obstacle.y);
                    } else if (!player.jumping && obstacle.onGround) {
                        // ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø­ÙØ±Ø© ÙÙŠ Ø§Ù„Ø£Ø±Ø¶
                        gameOver();
                    } else if (!player.jumping) {
                        // ØªØµØ§Ø¯Ù… Ø¹Ø§Ø¯ÙŠ
                        gameOver();
                    }
                }
            });

            // Ø¬Ù…Ø¹ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ - Ù…Ù†Ø·Ù‚Ø© Ø£ÙƒØ¨Ø± Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
            for (let i = moneyCoins.length - 1; i >= 0; i--) {
                const coin = moneyCoins[i];
                const coinHitBox = {
                    x: coin.x - 10,
                    y: coin.y - 10,
                    width: coin.width + 20,
                    height: coin.height + 20
                };
                
                if (player.x < coinHitBox.x + coinHitBox.width &&
                    player.x + player.width > coinHitBox.x &&
                    player.y < coinHitBox.y + coinHitBox.height &&
                    player.y + player.height > coinHitBox.y) {
                    moneyCoins.splice(i, 1);
                    coins += 15;
                    score += 10;
                    createParticle(coin.x, coin.y);
                    checkLevelUp();
                }
            }
        }

        function draw() {
            // Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Ø´Ø©
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#98FB98');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ø±Ø³Ù… Ø§Ù„Ø®Ø·ÙˆØ·
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 4;
            ctx.setLineDash([30, 15]);
            
            const laneWidth = canvas.width / 3;
            for (let i = 1; i < 3; i++) {
                ctx.beginPath();
                ctx.moveTo(laneWidth * i, 0);
                ctx.lineTo(laneWidth * i, canvas.height);
                ctx.stroke();
            }

            // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ø¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø¨Ø³
            ctx.font = '60px Arial';
            ctx.textAlign = 'center';
            
            if (specialEffect) {
                ctx.shadowColor = '#FFD700';
                ctx.shadowBlur = 20;
            }
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
            let currentSprite;
            if (player.jumping) {
                currentSprite = player.character.jumping;
            } else if (player.landing) {
                currentSprite = player.character.landing;
            } else {
                // Ø­Ø±ÙƒØ© Ø§Ù„Ø¬Ø±ÙŠ
                const runIndex = Math.floor(player.runningFrame);
                currentSprite = player.character.running[runIndex];
            }
            
            // Ø±Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ©
            ctx.save();
            ctx.translate(player.x + player.width/2, player.y + player.height/2);
            
            if (player.jumping) {
                // Ø¯ÙˆØ±Ø§Ù† Ø®ÙÙŠÙ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù‚ÙØ²
                ctx.rotate(Math.sin(player.jumpHeight * 0.05) * 0.1);
            } else if (player.landing) {
                // Ø­Ø±ÙƒØ© Ø§Ù„Ù‡Ø¨ÙˆØ· - Ø§Ù†Ø­Ù†Ø§Ø¡ Ù„Ù„Ø£Ù…Ø§Ù…
                ctx.scale(1.1, 0.9);
            } else if (player.animating) {
                // Ø­Ø±ÙƒØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
                ctx.scale(1.05, 0.95);
            }
            
            // Ø±Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© (Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ù…Ø¯Ù…Ø¬Ø© ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©)
            if (player.currentClothes.includes('ğŸ‘®') || player.currentClothes.includes('ğŸ‘¨â€') || player.currentClothes.includes('ğŸ‘©â€')) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø´Ø®ØµÙŠØ© ÙƒØ§Ù…Ù„Ø©ØŒ Ø§Ø±Ø³Ù…Ù‡Ø§ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                ctx.fillText(player.currentClothes, 0, 0);
            } else {
                // Ø§Ø±Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                ctx.fillText(currentSprite, 0, 0);
            }
            
            ctx.restore();
            ctx.shadowBlur = 0;

            // Ø±Ø³Ù… Ø§Ù„Ø´Ø±Ø·ÙŠ Ù…Ø¹ Ø­Ø±ÙƒØ© Ø§Ù„Ø¬Ø±ÙŠ
            ctx.font = '50px Arial';
            police.runningFrame = (police.runningFrame + 0.15) % 2;
            const policeSprite = Math.floor(police.runningFrame) === 0 ? 'ğŸ‘®â€â™‚ï¸' : 'ğŸƒâ€â™‚ï¸';
            ctx.fillText(policeSprite, player.x + player.width/2, player.y + 100);

            // Ø±Ø³Ù… Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª - Ù‚Ø·Ø§Ø±Ø§Øª ÙˆØ³ÙŠØ§Ø±Ø§Øª
            ctx.font = '50px Arial';
            obstacles.forEach(obstacle => {
                ctx.save();
                ctx.translate(obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2);
                
                // ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒØ© Ø®ÙÙŠÙ Ù„Ù„Ù…Ø±ÙƒØ¨Ø§Øª
                if (obstacle.type.includes('ğŸš‚') || obstacle.type.includes('ğŸš†') || obstacle.type.includes('ğŸš„')) {
                    // Ø­Ø±ÙƒØ© Ø§Ù‡ØªØ²Ø§Ø² Ù„Ù„Ù‚Ø·Ø§Ø±Ø§Øª
                    ctx.translate(Math.sin(animationFrame * 0.3) * 1, 0);
                } else {
                    // Ø­Ø±ÙƒØ© Ø®ÙÙŠÙØ© Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª
                    ctx.translate(Math.sin(animationFrame * 0.2) * 0.5, 0);
                }
                
                ctx.fillText(obstacle.type, 0, 15);
                ctx.restore();
            });

            // Ø±Ø³Ù… Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
            moneyCoins.forEach((coin, index) => {
                ctx.save();
                ctx.translate(coin.x + coin.width/2, coin.y + coin.height/2);
                ctx.rotate((animationFrame + index * 10) * 0.1);
                ctx.fillText('ğŸ’°', 0, 10);
                ctx.restore();
            });

            // Ø±Ø³Ù… Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
            particles.forEach(particle => {
                const alpha = particle.life / particle.maxLife;
                ctx.fillStyle = `rgba(255, 215, 0, ${alpha})`;
                ctx.fillRect(particle.x, particle.y, 3, 3);
            });

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('score').textContent = score;
            document.getElementById('coins').textContent = coins;
            document.getElementById('level').textContent = level;

            animationFrame++;
        }

        function gameLoop() {
            if (!gameRunning) return;

            updatePlayer();
            createObstacle();
            createMoney();
            updateObstacles();
            checkCollisions();
            draw();

            // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø³Ø±Ø¹Ø© ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹ - Ø£Ø¨Ø·Ø£ Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©
            if (level <= 5) {
                gameSpeed += 0.001; // Ø¨Ø·ÙŠØ¡ Ø¬Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            } else if (level <= 10) {
                gameSpeed += 0.002; // Ø¨Ø·ÙŠØ¡
            } else {
                gameSpeed += 0.003; // Ø¹Ø§Ø¯ÙŠ
            }

            requestAnimationFrame(gameLoop);
        }

        // ØªØ­Ø¯ÙŠØ« Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©
        window.addEventListener('resize', () => {
            resizeCanvas();
            updatePlayerPosition();
            player.y = canvas.height - 150;
        });

        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                resizeCanvas();
                updatePlayerPosition();
                player.y = canvas.height - 150;
            }, 100);
        });

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ù„Ø§Ø¨Ø³
        updateClothesGrid();
    </script>
</body>
</html>
